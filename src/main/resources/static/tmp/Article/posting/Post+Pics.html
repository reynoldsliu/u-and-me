<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="dist/css/post.css">
    <link rel="stylesheet" href="dist/css/HeaderFooter.css">

    <title>發文頁面</title>
    <style>
        .navbar-brand {
            height: 70px;
        }

        .navbar-brand>img {
            height: 115px;
            margin-top: -23px;
        }
    </style>
</head>

<body>
<nav class="navbar navbar-expand-lg  bg-dark navbar-dark fixed-top">

    <div class="container-fluid">
        <a class="navbar-brand" href="#">
            <img src="./dist/img/uandmelogo-removebg-preview.png">

        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mx-auto mb-2 mb-lg-0 ">
                <li class="nav-item me-4">
                    <a class="nav-link" href="#">活動資訊</a>
                </li>
                </li>
                <li class="nav-item me-4">
                    <a class="nav-link" href="#">行程規劃</a>
                </li>
                </li>
                <li class="nav-item me-4">
                    <a class="nav-link" href="#">旅遊商城</a>
                </li>
                </li>
                <li class="nav-item me-4">
                    <a class="nav-link" href="#">論壇專區</a>
                </li>
                </li>

                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                       aria-expanded="false">客服專區</a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="#">Q&A專欄</a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="#">聯絡我們</a></li>
                    </ul>
                </li>
            </ul>
        </div>

        <ul class="navbar-nav mx-auto mb-2 mb-lg-0 ">
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                         class="bi bi-search" viewBox="0 0 16 16">
                        <path
                                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
                    </svg>
                </a>
            </li>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                         class="bi bi-person" viewBox="0 0 16 16">
                        <path
                                d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4Zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10Z" />
                    </svg>
                </a>

            </li>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                  fill="currentColor" class="bi bi-cart2" viewBox="0 0 16 16">
                    <path
                            d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5zM3.14 5l1.25 5h8.22l1.25-5H3.14zM5 13a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0z" />
                </svg>

                </a>
            </li>
            </li>
        </ul>

    </div>
    </div>
    </div>
</nav>
<div class="container-fluid" style="margin-top: 190px;margin-bottom: 200px ;">
    <div style="padding-left: 200px;padding-right: 200px;">
        <div>
            <h1 class="text-center">發表新文章</h1>
        </div>
        <main>
            <!-- 分類下拉式選單 -->
            <div>
                <button class="btn btn-primary mx-1" type="submit" id="shopBtn">商城</button>
                <button class="btn btn-primary mx-1" type="submit" id="schedBtn">行程</button>
                <button class="btn btn-primary mx-1" type="submit" id="groupBtn">揪團</button>




            </div>

            <div class="mb-3 mt-4">
                <label for="title" class="form-label">標題</label>

                <!-- 給要被傳送到後端的標籤id值 -->
                <input type="text" id="title" name="title" class="form-control" required>
            </div>
            <div class="mb-3 mt-4">
                <label for="content" class="form-label">內容</label>
                <!-- 給要被傳送到後端的標籤id值 -->
                <textarea id="content" name="content" rows="6" class="form-control" required></textarea>
            </div>



            <!-- 上傳多個檔案 -->
            <form id="picForm">
                <div class="mb-2 mt-5">
                    <p>上傳照片或影片</p>

                    <!-- 預設的檔案上傳欄位 -->
                    <div id="fileInputs" style="margin-bottom: 20px;">
                        <!-- 後端的@RequestParam參數 要跟前端的name相同命名 -->
                        <input type="file" name="files" class="form-control" enctype="multipart/form-data"
                               multiple="multiple" />
                    </div>
                    <button type="button" id="addFileInput" class="btn btn-secondary"
                            style="margin-bottom: 40px;">新增欄位</button>
                </div>
                <!-- <button type="submit" class="btn btn-primary-send">發表</button> -->

            </form>
            <button id="btnSubmit" class="btn btn-primary-send">發表</button>




        </main>
    </div>

    <!-- footer -->
</div>
<div class="container-fluid footer1">
    <footer class="row row-cols-1 row-cols-sm-2 row-cols-md-5 py-5 my- border-top">
        <div class="col mb-3">
            <a href="/" class="d-flex align-items-center mb-3 link-body-emphasis text-decoration-none">
                <svg class="bi me-2" width="40" height="32">
                    <use xlink:href="#bootstrap" />
                </svg>
            </a>
            <p class="text-body-secondary"
               style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;">&copy; 2023</p>
        </div>

        <div class="col mb-3">

        </div>



        <div class="col mb-3 mx-5" style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;">
            <h5>U&Me</h5>
            <ul class="nav flex-column">
                <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">活動資訊</a></li>
                <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">行程規劃</a></li>
                <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">旅遊商城</a></li>
                <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">論壇專區</a></li>
                <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">客服專區</a></li>
            </ul>
        </div>

        <div class="col mb-3 mx-5" style="font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;">
            <h5>Follow Us</h5>
            <ul class="nav flex-column">
                <li class="nav-item mb-2"><a href="#"
                                             class="nav-link p-0 text-body-secondary">E-mail:u-and-me@gamil.com</a></li>
                <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-body-secondary">Tel:02-22222222</a>

            </ul>
            </li>

        </div>
    </footer>
    <script src="assets/dist/js/bootstrap.bundle.min.js"></script>
    <script src="dist/js/post.js"></script>
    <script>
        const url = "http://localhost:8080/post";
        const post_picURL = "http://localhost:8080/post_pics";

        const articleTitle = document.querySelector('#title');
        const articleContent = document.querySelector('#content');


        let artId = 0; // 初始化 artId


        // 貼文分類按鈕按下去的效果
        document.addEventListener('DOMContentLoaded', function () {
            //避免在DOM尚未完全加載和解析之前執行代碼

            const shopBtn = document.getElementById('shopBtn');
            const schedBtn = document.getElementById('schedBtn');
            const groupBtn = document.getElementById('groupBtn');


            // 商城按鈕onclick事件
            shopBtn.addEventListener('click', function () {
                // 移除其他按钮的active
                schedBtn.classList.remove('active');
                groupBtn.classList.remove('active');

                // 被點擊按鈕轉為active狀態(CSS中有設定active狀態的樣式)
                shopBtn.classList.add('active');

                // 若選擇以商城版發文，向後端傳遞1的值
                artId = 1;
            });

            // 行程按鈕onclick事件
            schedBtn.addEventListener('click', function () {
                // 移除其他按钮的active
                shopBtn.classList.remove('active');
                groupBtn.classList.remove('active');

                // 被點擊按鈕轉為active狀態(CSS中有設定active狀態的樣式)
                schedBtn.classList.add('active');

                // 若選擇以行程版發文，向後端傳遞2的值
                artId = 2;
            });

            // 揪團按鈕onclick事件
            groupBtn.addEventListener('click', function () {
                shopBtn.classList.remove('active');
                schedBtn.classList.remove('active');

                groupBtn.classList.add('active');

                artId = 3;
            });


        });



        // 取得「檔案上傳欄位」element與
        const fileInputsContainer = document.getElementById('fileInputs');
        // 「新增欄位」element
        const addFileInputButton = document.getElementById('addFileInput');

        // 新增檔案欄位的onclick事件監聽
        addFileInputButton.addEventListener('click', function () {
            const newFileInput = document.createElement('input');
            newFileInput.type = 'file';
            newFileInput.name = 'files';
            newFileInput.className = 'form-control';

            // 在預設的上傳欄位<div id="fileInputs> 裡加入新增的欄位
            fileInputsContainer.appendChild(newFileInput);

        });


        document.querySelector('#btnSubmit').addEventListener('click', () => {

            const postData = {
                acTypeId: artId,
                articleTitle: articleTitle.value,
                articleContent: articleContent.value
            };





            fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(postData)
            })
                .then(response => response.json())
                .then(data => {
                    // 后端返回的数据
                    console.log(data);
                })
                .catch(error => {

                    console.error('Error:', error);
                });

            // 使用FormData型態處理form(picForm)裡面的檔案
            const formData = new FormData(picForm);

            fetch(post_picURL, {
                method: "POST",
                body: formData
            })
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        });




    </script>
</body>

</html>